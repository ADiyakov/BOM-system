# BOM_Builder --- конвейер подготовки ведомости покупных изделий

Этот репозиторий содержит набор скриптов для преобразования
конструкторских спецификаций (DOCX по ЕСКД) в:

1)  единый список BOM (таблица "как есть"),
2)  классифицированный BOM (Category),
3)  "сжатый" BOM по `Name` (для ускорения ручного анализа и последующего
    выделения SupplyDoc),
4)  ведомость покупных изделий (ВП) в требуемом формате,
5)  финальную ВП с заданными ширинами колонок и "переносом" текста в
    дополнительные строки (без wrap_text).

** Важно **  

Нет возможности задать структуру изделия. Пока    

------------------------------------------------------------------------

## 0. Требования

### Python

-   Python 3.10+ (проверено на 3.13)

### Пакеты

``` bash
pip install python-docx openpyxl
```

> Важно: пакет должен называться **python-docx**, а импорт в коде
> остаётся `from docx import Document`.

------------------------------------------------------------------------

## 1. Структура проекта

Рекомендуемая структура:

    BOM_Builder/
    │
    ├── parse_specs_to_bom_many.py
    ├── specs_list.py
    │
    ├── classify_category.py
    ├── compress_by_name.py
    ├── split_name_to_supplydoc.py
    │
    ├── format_vedomost_pokupnyh.py
    ├── wrap_to_rows_set_widths.py
    │
    └── specs/
        ├── КОР-xx.xx.xxx ... .docx
        └── ...

------------------------------------------------------------------------

## 2. Входные данные

### 2.1 Спецификации (DOCX)

Файлы лежат в папке:

    ./specs

### 2.2 Список спецификаций (specs_list.py)

`specs_list.py` содержит `SPECS` --- список пар
`(filename, module_code)`:

``` python
SPECS = [
    ("КОР-02.20.000 ... .docx", "КОР-02.20.000"),
    ("КОР-02.50.000 ... .docx", "КОР-02.50.000"),
]
```

------------------------------------------------------------------------

## 3. Конвейер: порядок прогонов

### Шаг 1 --- Парсинг DOCX → общий BOM

    python parse_specs_to_bom_many.py

### Шаг 2 --- Заполнение Category

    python classify_category.py

### Шаг 3 --- Ручная сортировка по Name (в Excel)

### Шаг 4 --- Сжатие по Name

    python compress_by_name.py

### Шаг 5 --- Разделение Name → Name_Clean + SupplyDoc

    python split_name_to_supplydoc.py

### Шаг 6 --- Формирование ведомости покупных

    python format_vedomost_pokupnyh.py

### Шаг 7 --- Финальное форматирование

    python wrap_to_rows_set_widths.py

------------------------------------------------------------------------

## 4. Типовые проблемы

### ModuleNotFoundError: No module named 'exceptions'

Удалить неправильный пакет и установить правильный:

``` bash
pip uninstall docx
pip install python-docx
```

### MergedCell object attribute 'value' is read-only

В листе есть объединённые ячейки --- разъединить merge перед финальным
форматированием.

------------------------------------------------------------------------

## 5. Рекомендации по Git

Пример `.gitignore`:

    out/
    *.xlsx
    __pycache__/

------------------------------------------------------------------------

Готово. Конвейер воспроизводим: от DOCX до финальной ВП с
форматированием.
